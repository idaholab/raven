<?xml version="1.0" ?>
<Simulation verbosity="debug">
  <TestInfo>
    <name>tests/framework/Postprocessors/SPSL</name>
    <author>Niharika Karnik (@nkarnik2999)</author>
    <created>2022-07-18</created>
    <classesTested>Postprocessors.SPSL</classesTested>
    <description>test SPSL reconstruction</description>
  </TestInfo>

  <RunInfo>
    <WorkingDir>reconstruction</WorkingDir>
    <Sequence>LoadCSV, mySPpp</Sequence>
    <batchSize>1</batchSize>
  </RunInfo>

  <Files>
    <Input name= 'twistFile' type= ''> /Users/karnn/projects/Sparse_Sensing_in_NDTs_LDRD/data/0_raw/004_BB_7Power_7BC/350_240.csv </Input> 
  </Files>


  <Steps>
   <IOStep name="LoadCSV">
      <Input class="Files" type="">twistFile</Input>
      <Output class="DataObjects" type="PointSet">TwistDO</Output>
    </IOStep>
    <PostProcess name="mySPpp">
      <Input class="DataObjects" type="PointSet">TwistDO</Input>
      <Model class="Models" type="PostProcessor">mySPSL</Model>
      <Output class="DataObjects" type="PointSet">outPP</Output>
    </PostProcess>
    <!-- <IOStep name="Plot">
      <Input class="DataObjects" type="PointSet">outMC</Input>
      <Input class="DataObjects" type="PointSet">outPP</Input>
      <Output class="OutStreams" type="Print">outPP</Output>
      <Output class="OutStreams" type="Plot">plotMC</Output>
    </IOStep> -->
  </Steps>

  <Models>
    <PostProcessor name="mySPSL" subType="SparseSensing" verbosity="debug">
      <Goal subType="reconstruction">
        <TrainingData>myDO</TrainingData>
        <features>x,y</features>
        <target>v</target>
        <basis>svd</basis> <!--Ddefault: svd-->
        <nModes>5</nModes> <!--default: opt, allows the algorithm to pick nModes-->
        <nSensors>5</nSensors><!--default: opt, allows the algorithm to pick nSensors-->
        <threshold>0.2</threshold>
        <optimizer>QR</optimizer><!--default: QR-->
      </Goal>
    </PostProcessor>
  </Models>

  <DataObjects>
    <PointSet name="TwistDO">
      <Input>"X (m)","Temperature (K)","Y (m)","Velocity[j] (m/s)","Z (m)","Velocity[i] (m/s)"</Input>
      <!-- <Output>OutputPlaceHolder</Output> -->
      <!-- <options>
        <pivotParameter>t</pivotParameter>
      </options> -->
    </PointSet>
    <!-- <PointSet name="romIn">
      <Input>angle</Input>
      <Output>OutputPlaceHolder</Output>
    </PointSet> -->
    <PointSet name="outPP">
      <Input>TwistDO</Input>
      <Output>sensor0,sensor1,sensor2,sensor3,sensor4</Output>
    </PointSet>
  </DataObjects>

  <OutStreams>
    <Print name="outMC">
      <type>csv</type>
      <source>outMC</source>
    </Print>
    <Print name="outPP">
      <type>csv</type>
      <source>outPP</source>
    </Print>
    <Plot name="plotMC">
      <plotSettings>
        <plot>
          <type>line</type>
          <x>outMC|Output|x</x>
          <y>outMC|Output|y</y>
          <c>blue</c>
        </plot>
        <!-- <plot>
          <type>scatter</type>
          <marker>+</marker>
          <x>romOut|Input|angle</x>
          <y>romOut|Output|r</y>
          <c>red</c>
        </plot> -->
        <xlabel>x</xlabel>
        <ylabel>y</ylabel>
      </plotSettings>
      <actions>
        <how>png</how>
      </actions>
    </Plot>
  </OutStreams>

</Simulation>